#pragma once
#include <stdint.h>
#include <stddef.h>

// ===== ESN Readout (header-only) =====
#define ESN_DIM 500

// Pesos do readout (float32)
static const float ESN_W[ESN_DIM] = {
  -31236.281, -40947.336, -16617.049, 21041.676, -39488.168, 8633.4268, -11858.268, 1721.8545,
  46742.043, -13618.869, -20913.359, 47785.711, -3695.7002, 12672.198, -9306.6592, 3928.9104,
  -53571.367, 10579.78, 294.21518, -19081.25, 38368.109, 48.157944, 18549.447, 45938.883,
  14957.558, -12726.593, 3625.719, 7662.1826, 12831.614, 10221.967, -31977.348, 3013.0801,
  -9103.9785, 14689.124, 26949.803, 1835.6151, 2808.6882, -2343.3262, 23634.564, -53488.797,
  46196.863, -4517.2661, -50177.688, 5046.439, 5127.8521, -21562.984, -27125.217, -995.96539,
  -17103.48, 14216.619, -52591.043, 12106.95, -1691.6333, 7924.2705, -2184.1211, 2967.1206,
  -23045.133, -13919.397, 10786.76, 86986.289, -14011.326, -25210.088, 14714.942, 1601.1467,
  -28372.641, -29648.709, 10320.979, 24460.277, -22089.941, -29177.404, -38652.887, 23523.732,
  16992.793, 4722.6377, -37929.242, 19386.273, -21913.762, -28842.039, 19276.014, 13015.61,
  -19683.439, 108757.27, 15161.378, -33385.609, -40845.395, 3883.4155, -11533.087, 6498.8975,
  1028.941, -4002.7637, -9322.9902, -2065.312, -37651.16, -14604.474, 5290.7437, -1389.958,
  3625.1741, 3615.2942, 35473.875, -3559.8535, 13347.428, 49517.703, 33919.055, 38545.246,
  -1993.3356, -9390.21, 39613.488, -28978.721, 9612.875, 102278.6, -32649.391, -54631.809,
  7983.8555, 1531.7535, 7259.3164, 20808.455, 4149.3047, -32316.768, -9093.5254, 26824.33,
  -15128.762, -4909.6865, 18046.939, -8874.9521, -1914.4424, -27768.037, -36334.328, -1257.9846,
  -13603.327, -13501.095, 41000.637, -6174.1724, -20232.301, 38319.352, -13982.997, 53978.008,
  -40624.211, -17456.66, -18663.523, 22428.703, -15669.195, 1226.7471, 12431.633, 20763.709,
  23730.949, 45121.949, 12905.041, -15111.232, 11443.583, 38333.461, 6885.2271, -8057.6836,
  11492.244, 42504.176, 31406.277, 11325.127, -27952.873, 22666.299, -4101.3481, 68307.242,
  -22635.475, -14919.414, -1315.09, 3847.634, -3019.6074, 8759.8135, -4871.5703, -19949.041,
  3855.8386, 13329.016, -36134.113, 6170.5918, 10222.71, -22230.533, 35371.137, -35194.469,
  25192.193, 3534.3416, -12399.102, -1177.8079, -2020.653, 24784.27, 8200.9219, 9800.3535,
  12637.154, -50.341969, -16320.444, -24162.662, 20919.441, 10307.786, 2629.6321, 62364.602,
  -15097.551, 17046.094, -331.77933, -4812.5386, 34512.977, 54023.023, -44234.031, 1277.2404,
  -8906.5361, -11351.453, -6167.5923, 10608.291, -20759.773, 37121.191, -11718.119, 2654.3813,
  -9290.2256, -21163.096, -5922.3584, -19604.627, -13270.922, -40079.469, 66210.07, 10008.081,
  2018.6346, -3743.8899, -27789.371, -10310.286, 26046.578, 49156.375, 15267.635, 38114.219,
  -11601.543, 2185.6404, 48612.09, -12201.224, -37088.789, 1477.6205, -24458.809, 13011.503,
  48515.402, 42623.09, 18803.629, 1573.446, 5769.0908, 4167.4526, 9826.5391, 100796.98,
  -41062.02, -4823.7676, 73361.266, -5444.2822, -16541.494, 16407.885, 42015.598, -24868.92,
  4521.752, 2664.374, 20251.689, -1111.5449, -20696.908, 10129.077, -22534.082, -15910.52,
  45377.23, 2451.9954, 34454.598, -720.83411, 14190.66, -17830.115, -57364.699, -11195.976,
  26989.029, 1986.6384, 24600.229, 21065.846, 142979.77, 19980.996, -5054.9468, 33573.996,
  6324.6187, -24423.199, -34627.5, 1072.8685, -33471.738, 7788.8809, -5200.1392, 13770.947,
  -5212.1797, 1320.7659, 21771.906, 3798.7375, 17123.348, 18400.086, 54714.41, -25897.721,
  -13850.097, -23939.541, -5981.2812, 25822.641, 44076.664, -6651.1626, -15867.271, 7992.9019,
  43564.703, 24478.127, 20923.199, 6918.8135, 5967.7036, -52238.629, 39487.004, -47652.312,
  -785.7475, 2414.7917, -67519.07, 34210.078, 2920.821, -33190.129, 5850.4829, -10440.251,
  15782.141, 24578.332, 20613.871, -22556.17, -25913.219, 31606.318, -30426.943, 50319.527,
  22627.074, -1625.4257, 777.00684, 1941.7056, -810.34875, 4164.0317, -33478.582, 5802.0337,
  8001.6377, -3132.9902, 38033.414, 6020.8252, -14135.246, -2813.3291, -10556.975, -20235.203,
  5255.3115, 4709.479, 114142.01, -7122.8071, -62046.922, 25479.893, 15202.477, 6260.1133,
  -22784.449, -35990.496, 2721.8943, -19296, -2631.0659, -35544.91, -8283.1006, -9700.5449,
  -411.74765, 90674.734, -17667.129, 37971.465, -13769.232, 495.10242, 18881.408, 27356.387,
  -1673.2469, -1863.6492, -20868.008, -7594.6323, 19726.795, 13528.687, -20596.277, 33526.441,
  5790.3945, -18137.311, 4808.1235, -88994.5, 9818.2598, 8874.4414, -23879.438, 23304.896,
  -42142.785, 20210.594, 21014.16, -19096.414, -6319.7046, -17161.076, 8945.6562, -7079.5977,
  257.30148, 35919.258, 2115.6697, 24843.271, 24044.523, 97342.883, 5878.3691, -19089.938,
  -11850.064, -80508.781, -18769.414, 8488.2285, 12128.15, 17391.047, -24558.326, -13586.331,
  -23989.973, 10235.63, -5255.3062, 32491.027, -10270.726, -26543.768, 23042.605, -42013.508,
  12716.884, -24700.598, -9328.4072, -19685.84, -17511.881, -24667.182, -47966.035, -13749.445,
  -33462.328, -49097.816, 147.18556, -3700.915, -17827.328, -25471.93, 39242.758, -62006.344,
  -19433.939, -6279.1553, 9092.8545, 22981.865, 5498.2983, -9401.1621, -67741.531, -3367.2263,
  22440.758, -31318.33, -4184.0254, 12756.734, -6558.5371, -15134.056, 1613.0397, 24263.707,
  -1904.2708, 3210.6262, -9899.4307, -24705.855, 75051.961, -44337.172, -6276.8071, 4228.2363,
  -16216.521, 25195.139, 9663.2715, -28327.777, -27113.287, -4857.2163, 6539.7788, -65881.258,
  4490.9712, 30514.141, -32024.697, 29248.027, 508.27841, -17449.469, 50756.613, -6961.7427,
  -9322.0752, -6123.6997, 21519.682, -35325.941, -34001.812, -9537.9258, 68319.344, 16217.962,
  15927.662, 13990.151, 11267.38, 35271.781, 10266.85, 12547.046, 27920.721, -2414.7173,
  32315.371, -303.8952, -5439.5059, 2054.019, 6741.2891, 6735.605, -11380.207, -15196.411,
  15339.857, -4827.5933, -21888.207, 13373.644, -8771.7578, 121412.61, 19273.029, 33870.613,
  3031.1929, 20442.994, 24817.002, -6556.979,
};

// Viés (bias)
static const float ESN_B = -72598.297;

// Inferência: y = dot(W, x) + B
static inline float esn_predict(const float x[ESN_DIM]) {
  float acc = ESN_B;
  for (int i = 0; i < ESN_DIM; ++i) acc += ESN_W[i] * x[i];
  return acc;
}
